language: ruby
cache:
  - yarn
  - bundler
rvm:
  - 2.4.1
env:
  # test/mailers, test/functional, test/controllers
  - TEST_SUITE=functionals
  # test/integration
  - TEST_SUITE=integration
  # test/unit, test/models, test/helpers
  - TEST_SUITE=units
before_install:
  - sudo apt-get install -y imagemagick
before_script:
  - bundle exec bin/setup
  - yarn install
script:
  - "bundle exec rake test:$TEST_SUITE"
services:
  - redis-server
addons:
  postgresql: '9.5'
  chrome: stable
  apt:
    update: true
notifications:
  slack:
    rooms:
      secure: {{SLACK_KEY}}
